@using RoastMeApplication.Models.Entities;
@using RoastMeApplication.Models.DAL;
@model Comment
@{
    ViewBag.Title = "Home Page";
    Picture p = this.ViewBag.picture as Picture;
    Participant CurrentParticipant = null;
    if (Session["participantID"] != null) {
        CurrentParticipant = ViewBag.Participant as Participant;
    }
}


<div class="row">

    <div class="picture_index" style="margin-top: 30px;">
        <div id="userInfo">
            <p class="index_username">@p.Participant.Username</p>
            <p class="index_caption">@p.Caption</p>
        </div>


        <hr />
            <img class="img-circle" src="~/Content/Images/@p.ImagePath" alt="Caption" height="450" width="450" />
        @* put flag underneath image *@   
        <hr />
        @*SEPARATION OF PICTURE ^ AND COMMENTS v *@


        @{
            List<Comment> comments = p.Comments.OrderByDescending(c => c.Time).ToList();
        }
        
        @using (Html.BeginForm("SubmitComment", "Comment", FormMethod.Post))
        {
            @Html.HiddenFor(m => m.PictureId, new { Value = p.Id})
            @Html.HiddenFor(m => m.ParticipantId, new { Value = CurrentParticipant.Id })
            <input type="hidden" name="" />
            <div>
                @Html.TextBoxFor(m => m.Message, htmlAttributes: new { placeholder = "Enter your comment", id = "comment-input" })
                <input type="submit" value="Roast"/>
            </div>
            <hr />
        }

        @if (comments != null && comments.Count != 0)
        {
            foreach (Comment c in comments)
            {
                int score = 0;
                foreach (Vote v in c.Votes)
                {
                    if (v.IsLike == true)
                    {
                        score++;
                    }else if(v.IsLike == false)
                    {
                        score++;
                    }
                }
                <div id="commentInfo">
                    <p class="index_username">@c.Participant.Username</p>
                    <p class="index_caption">@c.Message</p>
                    <hr />
                </div>

                <div id="score">
                    <p>score</p>
                    @using (Html.BeginForm("SubmitComment", "Comment", FormMethod.Post, new { enctype = "multipart/form-data" }))
                    {
                        <input type="s" value=""/>
                    }
                    @using (Html.BeginForm("SubmitComment", "Comment", FormMethod.Post, new { enctype = "multipart/form-data" }))
                    {
                        <input type="submit" value="Flag"/>
                    }
                </div>
            }
        }


    </div>

</div>


